[оглавление](../README.md)



## 8. Функции

В любом языке программирования существуют подпрограммы. В языке C они называются функциями, в ассемблере - подпрограммами, а в Pascal существуют даже два вида подпрограмм: процедуры и функции.

Подпрограмма - это специальным образом оформленный фрагмент программы, к которому можно обратиться из любого места внутри программы. Подпрограммы существенно упрощают жизнь программистам, улучшая читабельность исходного кода, а также сокращая его, поскольку отдельные фрагменты кода не нужно писать несколько раз

В PHP такими подпрограммами являются функции.

Помимо встроенных функций PHP, часто возникает необходимость создания пользовательских функций, выполняющих определенные задачи. В PHP программисту дана достаточно высокая свобода при создании пользовательских функций. В отличии от языка C++ в пользовательских функциях доступны параметры по умолчанию.

Синтаксис описания функций PHP прост и изящен: 


- вы можете использовать параметры по умолчанию (а значит, функции с переменным числом параметров); 
- каждая функция имеет собственный контекст (или область видимости) переменных, которая уничтожается при выходе из нее; 
- существует инструкция return, позволяющая вернуть результат вычисления из функции в вызывающую программу; 
- тип возвращаемого значения может быть любым; 
- при описании методов классов для параметров и возвращаемого значения функций возможно указание их типа (как в C++) с принудительной проверкой при вызове; 
- допускается создание анонимных функций.

В системе определения функций в PHP есть одна особенность, которая весьма неприятна тем, кто до этого программировал на других языках. Дело в том, что все переменные, которые объявляются и используются в функции, по умолчанию локальны для этой функции. Исправить ситуацию можно либо при помощи инструкции global (на самом деле есть и еще один, через массив $GLOBALS, но об этом чуть позже) или замыканий. В любом случае вам придется приложить усилия, чтобы передать значения как внутрь функции, так и за ее пределы. С одной стороны, это повышает надежность функций в смысле их изолированности от основной программы, а также гарантирует, что они случайно не изменят и не создадут глобальных переменных. 

Существуют встроенные и пользовательские функции. Встроенные функции – `print()`, `print_r()` и так далее – придумали разработчики. Пользовательские функции программисты пишут самостоятельно.



## 8.1. Как объявить функцию

Синтаксис функции:

```php
function имяФункции($аргументФункции1, $аргументФункции2, ...) {
	// код
	return результат;
}
```

**Здесь**:

`function` – мы говорим интерпретатору, что отсюда начинается функция.

`аргументФункции` – переменные, которые передаются функции для выполнения кода.

`имяФункции` – чтобы вызывать функцию, ей нужно присвоить имя.

`return` – выдает результат работы функции.

Напишем и вызовем функцию, выводящую на экран фразу `Hello, World`.

```php
<?php
function helloMessage(){
    return print("Hello, World.");
}

helloMessage(); // Hello, World. – вызов функции
    
```



## 8.2. Аргументы функций

До этого мы рассматривали функции без аргументов – переменных, которые функция получает извне. Напишем функцию с аргументами, которая считает сумму трех чисел:

```php
<?php
function summation($a, $b, $c){
    return print($a + $b + $c);

}

summation(1, 2, 3); // 6
summation(100, 74, 8); // 182

    
```

**Здесь**:

`$a`, `$b`, `$c` – аргументы функции.



## 8.3. Типы аргументов и возвращаемого значения 

Начиная с версии PHP 5, допускается указывать типы аргументов (объекты, массивы, интерфейсы, функции обратного вызова). В PHP 7 количество допустимых типов расширено булевым bool, целочисленным int, вещественным float и строковым string типами. Кроме того, PHP 7 позволяет задавать тип возвращаемого функцией значения, который указывается через двоеточие непосредственно перед телом функции:

```php
<?php 
## Типы аргументов и возвращаемого значения
function sum(int $fst, int $snd) : int
{
	return $fst + $snd;
}

echo sum(2, 2); // 4
echo sum(2.5, 2.5); // 4
```



## 8.4. Советы по использованию функций

- Не допускайте, чтобы ваши функции разрастались до гигантских размеров. Дробите их на маленькие, по возможности независимые, части, желательно полезные и сами по себе. Это повысит читабельность, устойчивость и переносимость ваших программ. В идеале каждая функция не должна занимать больше 20–30 строк, возможно, за редким исключением. Этот совет применим вообще ко всем языкам программирования, а не только к PHP. 

- Как известно, вызов функции отнимает какое-то время, поэтому распространено мнение, что чем меньше функций, тем быстрее работает программа. Оно в корне неверно: `не стоит обращать внимания на цену вызова функции, пока она сама о себе не заявит!` В конце концов, объединить несколько функций в одну всегда на порядок проще, чем разбить одну функцию на несколько. Помните об этом. 

- Чаще используйте стандартные, встроенные функции. Прежде чем писать какую-то процедуру, сверьтесь с документацией, — возможно, она уже реализована в ядре PHP. Если это так, то не думайте, что сможете написать ее эффективнее на PHP — ведь часто самый неэффективный C-код работает быстрее, чем самый изящный на PHP. Возможно, лучше пожертвовать качеством результата за счет быстродействия — например, при работе с базами данных и сложными файлами лучше применять стандартные функции сериализации, чем писать более плотно упаковывающие, но свои, потому что стандартные работают очень быстро. Правда, из этого правила существуют и исключения: например, мы бы не советовали вам использовать `serialize()` для формирования строки, сохраняющейся в cookies браузера — здесь лучше написать свои функции. 

- Действует принцип: чем меньше в программе собственноручно реализованных функций, тем надежнее она будет работать и тем меньше ее придется тестировать. Поэтому старайтесь опираться на код, который был написан и отлажен ранее — это касается как стандартных функций, так и сторонних библиотек на PHP. 

- Не пытайтесь оптимизировать программу, искусственно превращая параметры значения функций в параметры-ссылки — это не даст прироста производительности в PHP! Используйте ссылки только в тех ситуациях, когда процедура должна `действительно` изменить свой аргумент. 



### Источники

- https://proglib.io/
- http://www.php.su/
- PHP7. Дмитрий Котеров, Игорь Симдянов



[оглавление](../README.md)